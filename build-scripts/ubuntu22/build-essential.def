Bootstrap: docker
From: ubuntu:22.04

%labels
    Author Ziyue Cheng
    Version 1.0
    Description "Ubuntu22 with essential build tools"

%environment
    export LC_ALL=C.UTF-8
    export LANG=C.UTF-8
    export PS1='CNT \w> '

%runscript
    exec /bin/bash "$@"	

%post
    # Avoid interactive prompts
    export DEBIAN_FRONTEND=noninteractive

    apt -y update && apt -y upgrade

    ## C and C++
    apt -y install \
        build-essential pkg-config git wget curl zip \
        g++ clang gfortran \
        ninja-build make cmake doxygen autoconf automake

    ## RStudio libs
    apt -y install libssl-dev libclang-dev libsqlite3-0
    apt -y install pandoc # for markdown rendering

    ## Python
    apt -y install python3-pip python3-venv python-is-python3
    # PyTorch
    apt -y install libglib2.0-0 libsm6 libxrender1 libxext6

    ## R packages
    apt -y install libicu70             # stringr
    apt -y install libcurl4-openssl-dev # curl
    apt -y install libcairo2-dev        # Cario
    apt -y install libmagick++-dev      # magick
    apt -y install libharfbuzz-dev libfribidi-dev libfreetype6-dev # textshaping
    apt -y install libudunits2-dev      # units
    apt -y install libgdal-dev libgeos-dev libproj-dev libsqlite3-dev gdal-bin # sf
    apt -y install libabsl-dev # s2
    apt -y install libglpk-dev # scDblFinder
    apt -y install libhdf5-dev # BPCells

    apt clean
